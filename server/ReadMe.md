# TeaTalk   

<br />

# Backend Documentation

<br />

<!-- # Base URL for Deployed API

https://water-my-plants-buildweek.herokuapp.com/api -->

# Endpoints
| Request | URL                | Description |
| ------- | -----------------  | ----------- |
| POST    | /users             | register as a new user |
| POST    | /users/login       | login as an existing user |
| POST    | /teas              | adds a new Tea to the database |
| GET     | /users/:id         | gets user info for user with given id |
| GET     | /teas              | gets an array of all teas in the database |
| GET     | /teas/:id          | gets info for Tea with given id |
| PATCH   | /users/:id         | edits info for user with given id |
| PATCH   | /users/:id/teaLists| edits the "teaLists" object for user with given id |
| PATCH   | /users/:id/ratings | edits the "ratedTeas" object for user with given id |
| PATCH   | /teas/:id          | edits info for Tea with given id |
| DELETE  | /users/:id         | deletes user with given id |
| DELETE  | /teas/:id          | deletes Tea with given id |

<br />
<br />

# Schemas

## Users
| Name         | Type            | Required | Unique | Notes                           | Default Value |
| ------------ | --------------- | -------- | ------ | ------------------------------- | ----------------- |
| _id          | string          | yes      | yes    | user id (auto generated by API) | \-                |
| username     | string          | yes      | yes    | user's username                 | \-                |
| password     | string          | yes      | no     | user's password                 | \-                |
| email        | string          | yes      | no     | user's email address            | \-                |
| teaLists     | Map (of Arrays) | no       | no     | user's saved Tea Lists          | {"Favorites": []} |
| ratedTeas    | Map (of Numbers)| no       | no     | user's saved Tea Lists          | {}                |
| userImageURL | string          | no       | no     | URL to user's profile image     | \-                |
  
## Teas
| Name            | Type    | Required | Unique | Notes |
| --------------- | ------- | -------- | ------ | ----- |
| _id             | string  | yes      | yes    | Tea id (auto generated by API) |
| name            | string  | yes      | no     | Tea name |
| brand           | string  | yes      | no     | The brand or manufacturer of the Tea |
| type            | string  | yes      | no     | The type of Tea (black, green, oolong, herbal, etc.) |
| imgURL          | string  | no       | no     | URL to image of tea |
| ratingsTotal    | number  | no       | no     | Total of all user ratings |
| numberOfRatings | number  | no       | no     | Number of users who have rated |

<br />
<br />

# Requests and Returns:

### POST /users
Request Body:
```json
  {
    "username": "DragonOfTheWest",
    "password": "strongpassword",
    "email": "iroh@firenation.com"
  }
```

Returns:
```json
  {
    "_id": "643ac8ea0f61da490686c4ff",
    "username": "DragonOfTheWest",
    "email": "iroh@firenation.com",
    "teaLists": {
        "Favorites": []
    },
    "ratedTeas": {},
    "__v": 0
  }
```  
<br />
<br />


### POST /users/login
Request Body:
```json
  {
    "username": "DragonOfTheWest",
    "password": "strongpassword"
  }
```

Returns:
```json
  {
    "_id": "643ac8ea0f61da490686c4ff",
    "username": "DragonOfTheWest",
    "email": "iroh@firenation.com",
    "teaLists": {
        "Favorites": []
    },
    "ratedTeas": {},
    "__v": 0
  }
```

<br />
<br />

### POST /teas
Request Body:
*(If no image is provided, a default image will be added)*
```json
  {
    "name": "Earl Grey",
    "brand": "Bigelow",
    "type": "Black"
  }
```

Returns:
```json
  {
    "name": "Earl Grey",
    "brand": "Bigelow",
    "type": "Black",
    "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1679962610/default_tea_yj99v2.png",
    "ratingsTotal": 0,
    "numberOfRatings": 0,
    "_id": "643acaee0f61da490686c505",
    "__v": 0
  }
```

<br />
<br />

### GET /users/:id
Returns:
```json
  {
    "_id": "643ac8ea0f61da490686c4ff",
    "username": "DragonOfTheWest",
    "email": "iroh@firenation.com",
    "teaLists": {
        "Favorites": []
    },
    "ratedTeas": {},
    "__v": 0
  }
```

<br />
<br />

### GET /teas
Returns:
```json
  [
    {
      "_id": "63f8f1b504965fb08f2bee80",
      "name": "British Blend",
      "brand": "Tetly",
      "type": "Black",
      "__v": 0,
      "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1679962610/default_tea_yj99v2.png",
      "numberOfRatings": 1,
      "ratingsTotal": 4
    },
    {
      "_id": "63f8f4e80e1be62b7042d82b",
      "name": "Original Blend",
      "brand": "Red Rose",
      "type": "Black",
      "__v": 0,
      "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1679965692/IMG_3978_jkh5fe.jpg",
      "numberOfRatings": 1,
      "ratingsTotal": 5
    },
    {
      "_id": "641e6a2ba27aad41448d599d",
      "name": "Earl Grey",
      "brand": "Bigelow",
      "type": "Black",
      "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1680216616/BigelowEarlGrey_thbskp.jpg",
      "ratingsTotal": 4,
      "numberOfRatings": 1,
      "__v": 0
    },
    {
      "_id": "6426130ef0721ad677db6e20",
      "name": "Earl Grey Decaffeinated",
      "brand": "Bigelow",
      "type": "Black",
      "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1680216845/m6koufqb2lksencin69s.jpg",
      "ratingsTotal": 0,
      "numberOfRatings": 0,
      "__v": 0
    },
  ]
```

<br />
<br />

### GET /teas/:id
Returns:
```json
  {
    "_id": "63f8f4e80e1be62b7042d82b",
    "name": "Original Blend",
    "brand": "Red Rose",
    "type": "Black",
    "__v": 0,
    "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1679965692/IMG_3978_jkh5fe.jpg",
    "numberOfRatings": 1,
    "ratingsTotal": 5
  }
```

<br />
<br />


### PATCH /users/:id
Request Body:
```json
  {
    "username": "UncleIroh"
  }
```
Returns:
```json
  {
    "_id": "643ac8ea0f61da490686c4ff",
    "username": "UncleIroh",
    "email": "iroh@firenation.com",
    "teaLists": {
        "Favorites": []
    },
    "ratedTeas": {},
    "__v": 0
  }
```

<br />
<br />

### PATCH /users/:id/tealists
Tea Lists can be Created, Read, Updated, or Deleted. Because of this, it must be identified what the user is attempting to do by providing an "action" within the request body, along with an optional "payload" of the data to be updated.

**Only the Tea ID** needs to be provided. All other related Tea info will be populated automatically.

#### Action Options

| Action           | Description |
| ---------------- | ----------- |
| "new list"       | Creates a new list |
| "delete list"    | Deletes an existing list |
| "add tea"        | Adds one tea to an existing list |
| "remove tea"     | Adds one tea to an existing list |

Request Body:
```json
  {
    "action": "add tea",
    "payload": {
      "listName": "Favorites",
      "tea": "64262fa4802680e72ab7b04a"
    }
  }
```

Returns:
```json
  {
    "message": "Added 64262fa4802680e72ab7b04a to Favorites",
    "teaLists": {
      "Favorites": [
        {
          "_id": "64262fa4802680e72ab7b04a",
          "name": "Just Ginseng",
          "brand": "Jasmine Dragon",
          "type": "Green",
          "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1680224164/ws12dmtenuxs0uenxb57.jpg",
          "ratingsTotal": 0,
          "numberOfRatings": 0,
          "__v": 0
        }
      ]
    }
  }
```

<br />
<br />

### PATCH /users/:id/ratings
**Only the Tea ID** needs to be provided.
Request Body:
```json
  {
    "tea": "64262fa4802680e72ab7b04a",
    "rating": 5
  }
```

Returns:
```json
  {
    "_id": "64262fa4802680e72ab7b04a",
    "name": "Just Ginseng",
    "brand": "Jasmine Dragon",
    "type": "Green",
    "imageURL": "https://res.cloudinary.com/dl3ncuzpg/image/upload/v1680224164/ws12dmtenuxs0uenxb57.jpg",
    "ratingsTotal": 5,
    "numberOfRatings": 1,
    "__v": 0
  }
```

<br />
<br />


<!-- ### PATCH /teas/:id

Request Body:
```json

```

Returns
```json

```

<br />
<br />


### DELETE /users/:id

Request Body:
```json

```

Returns
```json

```

<br />
<br />


### DELETE /teas/:id

Request Body:
```json

```

Returns
```json

``` -->